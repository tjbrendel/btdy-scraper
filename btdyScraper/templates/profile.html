{% extends "base.html" %}

{% block content %}
    <div class="col-md-9">
        <div class="content-section">
            <h4>{{user.username}}'s Profile</h4>
        </div>

        {% for league in leagues %}
        <div class="modal fade" id="deleteLeagueModal{{ league.id }}">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <p>Are you sure you want to delete this league?</p>
                        <p>All series associated with it and race data will also be deleted. Make sure you want to do this.</p>
                    </div>
        
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary btn-sm" data-bs-dismiss="modal">Return</button>
                        <a class="btn btn-sm btn-danger" href="{% url 'btdyScraper-deleteLeague' league.leagueUrl %}">Confirm Delete</a></td>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

        {% for item in series %}
        <div class="modal fade" id="deleteSeriesModal{{ item.id }}">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <p>Are you sure you want to delete this series?</p>
                        <p>All race data associated with this series will also be deleted. Make sure you want to do this.</p>
                    </div>
        
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary btn-sm" data-bs-dismiss="modal">Return</button>
                        <a class="btn btn-sm btn-danger" href="{% url 'btdyScraper-deleteSeries' item.leagueID.leagueUrl item.seriesUrl %}">Confirm Delete</a></td>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

        <div class="content-section">
            {% if leagues %}
                <div class="row">
                    <div class="col-md-9">
                        <h5>Leagues I Own</h5>
                    </div>
                    <div class="col-md-3">
                        <a class="btn btn-primary" href="{% url 'btdyScraper-addLeague' %}">Create a New League</a>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-sm table-striped small">
                        <thead>
                            <tr>
                                <th>League ID</th>
                                <th>League Name</th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>
                        {% for league in leagues %}
                            <tr>
                                <td>{{ league.id }}</td>
                                <td>{{ league.leagueName }}</td>
                                <td class="text-center"><a class="btn btn-sm btn-primary" href="{% url 'btdyScraper-addSeries' league.leagueUrl %}">Add Series</a></td>
                                <td class="text-center"><a class="btn btn-sm btn-primary" href="{% url 'btdyScraper-editLeague' league.leagueUrl %}">Edit League</a></td>
                                <td class="text-center"><a class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#deleteLeagueModal{{ league.id }}">Delete League</a></td>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
            {% else %}
                <div class="row">
                    <div class="col-md-9">
                        <h5>Leagues I Own</h5>
                    </div>
                    <div class="col-md-3">
                        <a class="btn btn-primary" href="{% url 'btdyScraper-addLeague' %}">Create a New League</a>
                    </div>
                </div>
                <p>You don't own any leagues yet!</p>
            {% endif %}
        </div>

        
        <div class="content-section">
            <h5>Series I Admin</h5>
            {% if series %}
                <div class="table-responsive">
                    <table class="table table-sm small table-striped">
                        <thead>
                            <tr>
                                <th>League</th>
                                <th>Series</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>
                        {% for item in series %}
                            <tr>
                                <td>{{ item.leagueID.leagueName }}</td>
                                <td>{{ item.seriesName }}</td>
                                <td class="text-center"><a class="btn btn-sm btn-primary" href="{% url 'btdyScraper-add' item.leagueID.leagueUrl item.seriesUrl %}">Add a Race</a></td>
                                {% if item.leagueID.leagueOwner.username == user.username %}
                                    <td class="text-center"><a class="btn btn-sm btn-primary" href="{% url 'btdyScraper-addAdmin' item.leagueID.leagueUrl item.seriesUrl %}">Add Admin</a></td>
                                    <td class="text-center"><a class="btn btn-sm btn-primary" href="">Edit Series</a></td>
                                    <td class="text-center"><a class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#deleteSeriesModal{{ item.id }}">Delete Series</a></td>
                                {% else %}
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                {% endif %}
                            </tr>
                        {% endfor %}
                    </table>
                </div>
            {% else %}
                <p>You don't admin any series yet!</p>
            {% endif %}
        </div>
    </div>
{% endblock content %}